
# serializer

## task
Десериализатор выполняет функцию обратную сериализатору. Модуль “набирает”
выходное слово из валидных входных бит начиная с нулевого бита. Как только набралось
16 валидных бит модуль выдает данные на выход.

## desc

| Имя сигнала      | Напр-е | Разрядность | Комментарий                                                                                                     |
| ---------------- | ------ | ----------- |:--------------------------------------------------------------------------------------------------------------- |
| clk_i            | input  | 1           | Тактовый сигнал.                                                                                                |
| srst_i           | input  | 1           | Синхронный сброс.                                                                                               |
| data_i           | input  | 1           | Входные данные.                                                                                                 |
| data_val_i       | input  | 1           | Каждый валидный бит посылки,<br>поступающий на data_i сопровождается<br>активным состоянием этого сигнала (“1”) |
| deser_data_o     | output | 16          | «Сериализованные» данные. Самый старший тот,<br>что первым был первым на входе data_i.                          |
| deser_data_val_o | output | 1           | Подтверждает валидность deser_data_o.                                                                           |


### alg
- 3 последовательных блока, для контроля :
    - итератора mod_counter
    - бита валидности deser_data_val_o
    - десериализованных данных deser_data_o
- Остановка итератора происходит за счет следующих условий: либо срабатывание reset, либо равенство итератора с кол-вом валидных бит, либо валидность десериализатора deser_data_val_o положительная.
- Передача во внешнюю среду происходит за 1 такт, после этого будут набираться новые значения
- Запись идет по возрастанию, то есть первый data_i записывается как старший (16 - mod_counter - 1)

### test
В скрипте для ModelSim вызываются 2 собственные функции do_compile start_sim

В начале testbench происходит первичная инициализация, до момента когда rst_done станет равен 1.

Отправка проводится за счет генерации входной последовтельности и побитовой передачи в data_i. В цикле таска send_data каждый такт меняется значение data_i и data_val, причем посылка идет непрерывно из-за постоянной валидности равной 1. Тем самым можно покрыть все возможные наборы данных, перебор происходит быстро.

После отправки целого числа, происходит запись в локальную переменную ser_data для сохранения, сгенерированного циклом - j, и последующего тестирования десериализатора. Обработанные модулем данные переворачиваются для сравнения с изначальными данными, и результат записывается в test_bit. Сравнение происходит в момент, когда десериализатор дал сигнал о получении 16 бит "посылки" с помощью бита валидности deser_data_val.

Для записи не прошедших тестов используется бесконечная очередь, в конец записываются "координаты" теста. В дополнение в консоль выводятся сообщения о состоянии переменных и результаты теста на каждый цикл передачи. В конце, если ошибок не обнаружено выводится сообщение "ALL TESTS PASSED", иначе по очереди будут написаны координаты плохих тестов.

## install

```
git clone https://github.com/t1msi/fpga_lab_1.git
cd fpga_lab_1/1_2_deserializer/tb/
vsim&

do make.tcl
```

## ref
- https://www.youtube.com/playlist?list=PLOiK7Vmp7kf-YmjuuJKvDvmJdxKs826kx
- https://github.com/stcmtk/fpga-webinar-2020
- https://github.com/johan92/fpga-for-beginners
- https://habr.com/en/articles/281525/